#import sockect library
import socket

#define a funtion that return a ftp banner
def getBanner(ip,port):
	try:
		socket.setdefaulttimeout(2)
		#instantiate socket class
		s=socket.socket()
		#try to connect to the ftp's server
		s.connect((ip,port))
		banner=s.recv(1024)
		return banner
	except:
		return False

#define a function to print a message if the ftp is vulnerable
def checkVulns(banner):
	if( "FreeFlloat Ftp Server (Version 1.00)" in banner ):
                print "[+] FreeFloat FTP Server is vulnerable."
        elif( "3Com 3CDaemon FTP Server Version 2.0" in banner ):
                print "[+] 3CDaemon FTP Server is vulnerable."
        elif( "220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.1.65]" in banner ):
                print "[+] 220 ProFTPD 1.3.1 Server is vulnerable"

def main():
	#add a loop for a ip's range
	for x in range(1,66):
		#concatenate the ip
		ip="192.168.1."+str(x)

		#try to get the banner from ftp's server
		banner=getBanner(ip,21)
		#check if we got any possible vulnerable machine
		if banner:
			print "ip "+ip+" looks like is vulnerable"
			checkVulns(banner)
		else:
			print "ip "+ip+" is not vulnerable"


if __name__ == '__main__':
	main()
