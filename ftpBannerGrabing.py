#import sockect library
import socket

#define a funtion that return a ftp banner
def getBanner(ip,port):
	try:
		socket.setdefaulttimeout(2)
		#instantiate socket class
		s=socket.socket()
		#try to connect to the ftp's server
		s.connect((ip,port))
		banner=s.recv(1024)
		return banner
	except:
		return False

#function to check some vulnerable banners
def checkVulns(banner):
	#open the banners file in read mode
	file=open("vuln_banners.txt","r")
	#get all file lines as a list and loop through them
	for line in file.readlines():
		#strip off the newline character and compare with the banner message
       		if line.rstrip("\n") in banner :
			print "[+]looks like this service is vulnerable :)"
	file.close()

#program starts here!!
def main():
	#list with some ports
	portList=[ 21,22,25,80,110,443,3306 ]
	#loop through ips range
	for ipNum in range(64,66):
		#concatenate the ip
		ip="192.168.1."+str(ipNum)
		#now let's check each port, and check if we got some info
		for port in portList:
			#try to connect to the machine
			banner=getBanner(ip,port)
			#check if we got some banner
			if banner:
				#output the current ip and port for the banner
				print "ip "+ip+" port "+str(port)
				#output the banner message from service
				print banner
				#check if the current banner corresponds to a vulnerable version 
				checkVulns(banner)


if __name__ == '__main__':
	main()
