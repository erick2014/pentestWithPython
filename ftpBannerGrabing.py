#import sockect library
import socket

#define a funtion that return a ftp banner
def getBanner(ip,port):
	try:
		socket.setdefaulttimeout(2)
		#instantiate socket class
		s=socket.socket()
		#try to connect to the ftp's server
		s.connect((ip,port))
		banner=s.recv(1024)
		return banner
	except:
		return False

#define a function to determine if the ftp is vulnerable
def checkVulns(banner):
	if( "FreeFlloat Ftp Server (Version 1.00)" in banner ):
                print "[+] FreeFloat FTP Server is vulnerable."
        elif( "3Com 3CDaemon FTP Server Version 2.0" in banner ):
                print "[+] 3CDaemon FTP Server is vulnerable."
        elif( "220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.1.65]" in banner ):
                print "[+] 220 ProFTPD 1.3.1 Server is vulnerable"
def main():
	ip1='192.168.1.5'
	ip2='192.168.1.65'
	port=21
	#try to get the ftp's banner using ip1
	banner=getBanner(ip1,port)
	if banner:
		checkVulns(banner)
	#try to get the ftp's  banner using ip2
	banner=getBanner(ip2,port)
	if banner:
		checkVulns(banner)


if __name__ == '__main__':
	main()
