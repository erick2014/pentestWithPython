#import sockect library
import socket

#define a funtion that return a ftp banner
def getBanner(ip,port):
	try:
		socket.setdefaulttimeout(2)
		#instantiate socket class
		s=socket.socket()
		#try to connect to the ftp's server
		s.connect((ip,port))
		banner=s.recv(1024)
		return banner
	except:
		return False

#define a function to print a message if the ftp is vulnerable
def checkVulns(banner):
	if( "FreeFlloat Ftp Server (Version 1.00)" in banner ):
                print "[+] FreeFloat FTP Server is vulnerable."
        elif( "3Com 3CDaemon FTP Server Version 2.0" in banner ):
                print "[+] 3CDaemon FTP Server is vulnerable."
        elif( "220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.1.65]" in banner ):
                print "[+] 220 ProFTPD 1.3.1 Server is vulnerable"


def main():
	#list with some ports
	portList=[ 21,22,25,80,110,443,3306 ]
	#loop through ips range
	for ipNum in range(64,66):
		#concatenate the ip
		ip="192.168.1."+str(ipNum)
		#now let's check each port, and check if we got some info
		for port in portList:
			#try to connect to the machine
			banner=getBanner(ip,port)
			#check if we got some banner
			if banner:
				#output the current ip and port for the banner
				print "ip "+ip+" port "+str(port)
				#output the banner message from service
				print banner
				#check if the current banner corresponds to a vulnerable version 
				checkVulns(banner)


if __name__ == '__main__':
	main()
